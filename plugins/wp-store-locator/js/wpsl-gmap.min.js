var wpsl=wpsl||{};function wpslBorlabsCallback(){var e;e=setInterval((function(){"object"==typeof google&&"object"==typeof google.maps&&(clearInterval(e),initWpsl())}),500)}function wpslCallback(){jQuery(document).ready((function($){initWpsl()}))}function initWpsl(){if(jQuery(".wpsl-gmap-canvas").each((function(e){var t=jQuery(this).attr("id");wpsl.gmaps.init(t,e)})),"object"==typeof wpslAddons)for(const e in wpslAddons)wpslAddons.hasOwnProperty(e)&&wpslAddons[e].init()}wpsl.gmaps={},jQuery(document).ready((function($){var e,t,s,o,n,l,i,a,r,p,c,d,w,g,u,m=[],f=[],h=[],v={},S={},b={},y=!1,C=!1,L="undefined"!=typeof wpslSettings?wpslSettings.autoLoad:"",k={},x={enabled:void 0!==wpslSettings.collectStatistics,addressComponents:""};function I(){var e,t,s={};return void 0!==wpslSettings.infoWindowStyle&&"infobox"==wpslSettings.infoWindowStyle?(e=wpslSettings.infoBoxClearance.split(","),t=wpslSettings.infoBoxPixelOffset.split(","),s={alignBottom:!0,boxClass:wpslSettings.infoBoxClass,closeBoxMargin:wpslSettings.infoBoxCloseMargin,closeBoxURL:wpslSettings.infoBoxCloseUrl,content:"",disableAutoPan:!!Number(wpslSettings.infoBoxDisableAutoPan),enableEventPropagation:!!Number(wpslSettings.infoBoxEnableEventPropagation),infoBoxClearance:new google.maps.Size(Number(e[0]),Number(e[1])),pixelOffset:new google.maps.Size(Number(t[0]),Number(t[1])),zIndex:Number(wpslSettings.infoBoxZindex)},i=new InfoBox(s)):i=new google.maps.InfoWindow,i}function M(e,t){G(e,0,"",!0,t),W(e,y,L,t)}function E(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}function N(e,t){if(navigator.geolocation){var s,o,n=Number(wpslSettings.geoLocationTimeout);s=setInterval((function(){$(".wpsl-icon-direction").toggleClass("wpsl-active-icon")}),600),o=setTimeout((function(){R(s),M(e,t)}),n),navigator.geolocation.getCurrentPosition((function(n){R(s),clearTimeout(o),X(false),O(e,n,y,t),$(".wpsl-search").addClass("wpsl-geolocation-run")}),(function(s){if($(".wpsl-icon-direction").hasClass("wpsl-user-activated")&&!$(".wpsl-search").hasClass("wpsl-geolocation-run")){switch(s.code){case s.PERMISSION_DENIED:alert(wpslGeolocationErrors.denied);break;case s.POSITION_UNAVAILABLE:alert(wpslGeolocationErrors.unavailable);break;case s.TIMEOUT:alert(wpslGeolocationErrors.timeout);break;default:alert(wpslGeolocationErrors.generalError)}$(".wpsl-icon-direction").removeClass("wpsl-active-icon")}else $(".wpsl-search").hasClass("wpsl-geolocation-run")||(clearTimeout(o),M(e,t))}),{maximumAge:6e4,timeout:n,enableHighAccuracy:!0})}else alert(wpslGeolocationErrors.unavailable),M(e,t)}function R(e){clearInterval(e),$(".wpsl-icon-direction").removeClass("wpsl-active-icon")}function O(e,s,o,n){if(void 0===s)M(e,n);else{var l=new google.maps.LatLng(s.coords.latitude,s.coords.longitude);k={position:s,newRequest:!0},t.setCenter(l),G(l,0,"",!0,n),W(l,o,L,n)}}function P(){void 0!==wpslSettings.infoWindowStyle&&"infobox"==wpslSettings.infoWindowStyle&&void 0!==m[0]&&m[0].close()}function z(e,s){$(".wpsl-icon-reset, #wpsl-reset-map").on("click",(function(){$(this).hasClass("wpsl-in-progress")||(1==wpslSettings.autoLoad&&(L=1),t.getCenter().lat()===b.centerLatlng.lat()&&t.getCenter().lng()===b.centerLatlng.lng()&&t.getZoom()===b.zoomLevel||(X(!1),$("#wpsl-search-input").val("").removeClass(),$(".wpsl-icon-reset").addClass("wpsl-in-progress"),a&&a.clearMarkers(),U(),function(){var e,t,s,o,n,l,i,a,r=$("#wpsl-wrap").hasClass("wpsl-default-filters"),p=[wpslSettings.searchRadius+" "+wpslSettings.distanceUnit,wpslSettings.maxResults],c=["wpsl-radius","wpsl-results"];for(e=0,t=c.length;e<t;e++)$("#"+c[e]+" select").val(parseInt(p[e])),$("#"+c[e]+" li").removeClass(),"wpsl-radius"==c[e]?s=wpslSettings.searchRadius:"wpsl-results"==c[e]&&(s=wpslSettings.maxResults),$("#"+c[e]+" li").each((function(){$(this).text()===p[e]&&($(this).addClass("wpsl-selected-dropdown"),$("#"+c[e]+" .wpsl-selected-item").html(p[e]).attr("data-value",s))}));$("#wpsl-category").length&&($("#wpsl-category select").val(0),$("#wpsl-category li").removeClass(),$("#wpsl-category li:first-child").addClass("wpsl-selected-dropdown"),o=$("#wpsl-category li:first-child").text(),$("#wpsl-category .wpsl-selected-item").html(o).attr("data-value",0));$(".wpsl-custom-dropdown").length>0&&$(".wpsl-custom-dropdown").each((function(e){r?$(this).find("option").removeAttr("selected"):(n=$(this).siblings("div"),l=n.find("li:first-child"),i=l.text(),a=l.attr("data-value"),n.find("li").removeClass(),n.prev().html(i).attr("data-value",a))}))}(),1==wpslSettings.autoLocate?O(e,k.position,!0,s):M(e,s)),$("#wpsl-stores").show(),$("#wpsl-direction-details").hide())}))}function U(){void 0!==r&&""!==r&&(r.setMap(null),r="")}function T(e){var n,l,i,p,c;for(P(),c=e.parents("li").length>0?e.parents("li").data("store-id"):e.parents(".wpsl-info-window").data("store-id"),void 0!==r&&""!==r&&(l=r.getPosition()),S={centerLatlng:t.getCenter(),zoomLevel:t.getZoom()},n=0,p=f.length;n<p;n++)0!=f[n].storeId||void 0!==l&&""!==l?f[n].storeId==c&&(i=f[n].getPosition()):l=f[n].getPosition();l&&i?($("#wpsl-direction-details ul").empty(),$(".wpsl-direction-before, .wpsl-direction-after").remove(),function(e,n){var l,i,p,c,d,w,g,u,m,h="";g="km"==wpslSettings.distanceUnit?"METRIC":"IMPERIAL";m={origin:e,destination:n,travelMode:wpslSettings.directionsTravelMode,unitSystem:google.maps.UnitSystem[g]},o.route(m,(function(e,o){if(o==google.maps.DirectionsStatus.OK){if(s.setMap(t),s.setDirections(e),e.routes.length>0){for(c=e.routes[0],d=0;d<c.legs.length;d++)for(l=c.legs[d],w=0,i=l.steps.length;w<i;w++)p=l.steps[w],h=h+"<li><div class='wpsl-direction-index'>"+(w+1)+"</div><div class='wpsl-direction-txt'>"+p.instructions+"</div><div class='wpsl-direction-distance'>"+p.distance.text+"</div></li>";for($("#wpsl-direction-details ul").append(h).before("<div class='wpsl-direction-before'><a class='wpsl-back' id='wpsl-direction-start' href='#'>"+wpslLabels.back+"</a><div><span class='wpsl-total-distance'>"+c.legs[0].distance.text+"</span> - <span class='wpsl-total-durations'>"+c.legs[0].duration.text+"</span></div></div>").after("<p class='wpsl-direction-after'>"+e.routes[0].copyrights+"</p>"),$("#wpsl-direction-details").show(),d=0,i=f.length;d<i;d++)f[d].setMap(null);a&&a.clearMarkers(),void 0!==r&&""!==r&&r.setMap(null),$("#wpsl-stores").hide(),1==wpslSettings.templateId&&(u=$("#wpsl-gmap").offset(),$(window).scrollTop(u.top))}}else!function(e){var t;switch(e){case"NOT_FOUND":case"ZERO_RESULTS":t=wpslLabels.noDirectionsFound;break;case"OVER_QUERY_LIMIT":t=wpslLabels.queryLimit;break;default:t=wpslLabels.generalError}alert(t)}(o)}))}(l,i)):alert(wpslLabels.generalError)}function B(e,t){var s,o,n;for(s=0,o=f.length;s<o;s++)f[s].storeId==e&&(n=f[s],"start"==t?n.setAnimation(google.maps.Animation.BOUNCE):n.setAnimation(null))}function Z(t){var s={};if(void 0===wpslSettings.geocodeComponents||$.isEmptyObject(wpslSettings.geocodeComponents))s.address=$("#wpsl-search-input").val();else if(s.componentRestrictions=wpslSettings.geocodeComponents,void 0!==s.componentRestrictions.postalCode)switch(s.componentRestrictions.postalCode=$("#wpsl-search-input").val(),s.componentRestrictions.postalCode){case"2000":s.componentRestrictions={country:"BE",locality:"Antwerpen"};break;case"3130":s.componentRestrictions={country:"BE",locality:"Begijnendijk"};break;default:console.log("No postal code fixing necessary")}else s.address=$("#wpsl-search-input").val();e.geocode(s,(function(e,s){s==google.maps.GeocoderStatus.OK?(x.enabled&&V(e),j(e[0].geometry.location,t)):ee(s)}))}function j(e,t){G(e,0,"",!0,t),W(e,y,!1,t)}function A(t,s){var o,n=t.lat().toFixed(5),l=t.lng().toFixed(5);t.lat=function(){return parseFloat(n)},t.lng=function(){return parseFloat(l)},e.geocode({latLng:t},(function(e,t){t==google.maps.GeocoderStatus.OK?(1==wpslSettings.autoLocate&&k.newRequest&&(o=function(e){var t,s,o,n,l,i={},a=e.length;for(t=0;t<a;t++){for(n=e[t].address_components.length,s=0;s<n;s++){if(o=e[t].address_components[s].types,/^postal_code$/.test(o)||/^postal_code,postal_code_prefix$/.test(o)){i.zip=e[t].address_components[s].long_name;break}/^locality,political$/.test(o)&&(i.locality=e[t].address_components[s].long_name)}if(void 0!==i.zip)break}l=void 0===i.zip&&void 0!==i.locality?i.locality:i.zip;return l}(e),""!==o&&$("#wpsl-search-input").val(o),k.newRequest=!1),wpslSettings.directionRedirect&&(p=e[0].formatted_address),x.enabled&&$("#wpsl-search-input").val().length>0&&$.isEmptyObject(x.addressComponents)&&V(e),s()):ee(t)}))}function V(e){var t,s,o,n,l,i={},a={};for(n=function(e){var t="";return $.each(e[0].address_components,(function(s){if("country,political"==e[0].address_components[s].types.join(","))return t=e[0].address_components[s].short_name,!1})),t}(e),t="GB"==n?{city:"postal_town",city_locality:"locality,political",region:"administrative_area_level_2,political",country:"administrative_area_level_1,political"}:{city:"locality,political",region:"administrative_area_level_1,political",country:"country,political"},s=e[0].address_components.length,g=0;g<s;g++)for(var r in o=e[0].address_components[g].types,t)t[r]==o.join(",")&&(e[0].address_components[g].long_name.length>0?a[r]=e[0].address_components[g].long_name:a[r]=e[0].address_components[g].short_name);for(var r in t)void 0===a[r]&&(i[r]=t[r]);if("GB"==n&&void 0!==i.city_locality&&void 0===i.city&&(i={}),Object.keys(i).length>0)for(l=e.length,g=1;g<l;g++)for(s=e[g].address_components.length,u=0;u<s;u++)for(var r in o=e[g].address_components[u].types,i)t[r]==o.join(",")&&(a[r]=e[g].address_components[u].long_name);void 0!==a.city_locality&&a.city_locality.length>0&&(a.city=a.city_locality,delete a.city_locality),x.addressComponents=a}function W(e,t,s,o){1==wpslSettings.directionRedirect||x.enabled?A(e,(function(){D(e,t,s,o)})):D(e,t,s,o)}function D(e,s,o,n){var l,i,a="",r=$("#wpsl-listing-template").html(),p=$("#wpsl-stores ul"),c=wpslSettings.url+"img/ajax-loader.gif";i=function(e,t,s){var o,n,l,i,a,r="",p=$("#wpsl-wrap").hasClass("wpsl-mobile"),c=$("#wpsl-wrap").hasClass("wpsl-default-filters"),d={action:"store_search",lat:e.lat(),lng:e.lng()};t?(d.max_results=wpslSettings.maxResults,d.search_radius=wpslSettings.searchRadius):(p||c?(o=parseInt($("#wpsl-results .wpsl-dropdown").val()),n=parseInt($("#wpsl-radius .wpsl-dropdown").val())):(o=parseInt($("#wpsl-results .wpsl-selected-item").attr("data-value")),n=parseInt($("#wpsl-radius .wpsl-selected-item").attr("data-value"))),isNaN(o)?d.max_results=wpslSettings.maxResults:d.max_results=o,isNaN(n)?d.search_radius=wpslSettings.searchRadius:d.search_radius=n,void 0!==wpslSettings.categoryIds?d.filter=wpslSettings.categoryIds:$("#wpsl-category").length>0?(r=p||c?parseInt($("#wpsl-category .wpsl-dropdown").val()):parseInt($("#wpsl-category .wpsl-selected-item").attr("data-value")),isNaN(r)||0===r||(d.filter=r)):$("#wpsl-checkbox-filter").length>0&&$("#wpsl-checkbox-filter input:checked").length>0&&(d.filter=$("#wpsl-checkbox-filter input:checked").map((function(){return $(this).val()})).get().join(",")),$(".wpsl-custom-dropdown").length>0&&$(".wpsl-custom-dropdown").each((function(e){l="",i="",p||c?(l=$(this).attr("name"),i=$(this).val()):(l=$(this).attr("name"),i=$(this).next(".wpsl-selected-item").attr("data-value")),l&&i&&(d[l]=i)})),$(".wpsl-custom-checkboxes").length>0&&$(".wpsl-custom-checkboxes").each((function(e){(a=$(this).attr("data-name"))&&(d[a]=function(e){var t=$("[data-name="+e+"]"),s=[];return $(t).find("input:checked").each((function(e){s.push($(this).val())})),s.join()}(a))})));1==s&&(void 0!==k.position?d.skip_cache=1:(d.autoload=1,void 0!==wpslSettings.categoryIds&&(d.filter=wpslSettings.categoryIds)));x.enabled&&0==s&&(d.search=$("#wpsl-search-input").val(),d.statistics=x.addressComponents);return d}(e,s,o),p.empty().append("<li class='wpsl-preloader'><img src='"+c+"'/>"+wpslLabels.preloader+"</li>"),$("#wpsl-wrap").removeClass("wpsl-no-results"),$.get(wpslSettings.ajaxurl,i,(function(s){$(".wpsl-preloader").remove(),s.length>0&&void 0===s.addon?($.each(s,(function(e){_.extend(s[e],K),G(new google.maps.LatLng(s[e].lat,s[e].lng),s[e].id,s[e],false,n),a+=_.template(r)(s[e])})),$("#wpsl-result-list").off("click",".wpsl-directions"),p.empty(),p.append(a),$("#wpsl-result-list").on("click",".wpsl-directions",(function(){if(1!=wpslSettings.directionRedirect)return T($(this)),!1})),F(),$("#wpsl-result-list p:empty").remove()):(G(e,0,"",!0,n),l=function(){var e;e=void 0!==wpslSettings.noResults&&""!==wpslSettings.noResults?wpslSettings.noResults:wpslLabels.noResults;return e}(),$("#wpsl-wrap").addClass("wpsl-no-results"),p.html("<li class='wpsl-no-results-msg'>"+l+"</li>")),1==wpslSettings.runFitBounds?J():(t.setZoom(Number(wpslSettings.zoomLevel)),t.setCenter(f[0].position)),1==wpslSettings.resetMap&&($.isEmptyObject(b)&&google.maps.event.addListenerOnce(t,"tilesloaded",(function(){b={centerLatlng:t.getCenter(),zoomLevel:t.getZoom()},$("#wpsl-map-controls").addClass("wpsl-reset-exists"),$(".wpsl-icon-reset, #wpsl-reset-map").show()})),$(".wpsl-icon-reset").removeClass("wpsl-in-progress"))})),1!=wpslSettings.mouseFocus||E()||$("#wpsl-search-input").focus()}function F(){if(1==wpslSettings.markerClusters){var e,s=Number(wpslSettings.clusterZoom),o=Number(wpslSettings.clusterSize);isNaN(s)&&(s=""),isNaN(o)&&(o=""),void 0!==wpslSettings.excludeStartFromCluster&&1==wpslSettings.excludeStartFromCluster&&(e=f.slice(0)).splice(0,1),a=new MarkerClusterer(t,void 0===e?f:e,{gridSize:o,maxZoom:s})}}function G(e,s,o,n,l){var i,a,r,p;0===s?(o={store:wpslLabels.startPoint},i=v.url+wpslSettings.startMarker):i=void 0!==o.alternateMarkerUrl&&o.alternateMarkerUrl?o.alternateMarkerUrl:void 0!==o.categoryMarkerUrl&&o.categoryMarkerUrl?o.categoryMarkerUrl:v.url+wpslSettings.storeMarker,a={url:i,scaledSize:new google.maps.Size(Number(v.scaledSize[0]),Number(v.scaledSize[1])),origin:new google.maps.Point(Number(v.origin[0]),Number(v.origin[1])),anchor:new google.maps.Point(Number(v.anchor[0]),Number(v.anchor[1]))},r=new google.maps.Marker({position:e,map:t,optimized:!1,title:H(o.store),draggable:n,storeId:s,icon:a}),f.push(r),google.maps.event.addListener(r,"click",(p=t,function(){0!=s?void 0!==wpslSettings.markerStreetView&&1==wpslSettings.markerStreetView?function(e,t){(new google.maps.StreetViewService).getPanoramaByLocation(e,50,(function(e,s){C=s==google.maps.StreetViewStatus.OK,t()}))}(e,(function(){q(r,Y(o),l,p)})):q(r,Y(o),l,p):q(r,wpslLabels.startPoint,l,p),google.maps.event.clearListeners(l,"domready"),google.maps.event.addListener(l,"domready",(function(){!function(e,t){$(".wpsl-info-actions a").on("click",(function(s){var o=Number(wpslSettings.autoZoomLevel);if(s.stopImmediatePropagation(),$(this).hasClass("wpsl-directions")){if(1==wpslSettings.directionRedirect)return!0;T($(this))}else $(this).hasClass("wpsl-streetview")?function(e,t){var s=t.getStreetView();s.setPosition(e.getPosition()),s.setVisible(!0),$("#wpsl-map-controls").hide(),function(e,t){google.maps.event.addListener(e,"visible_changed",(function(){if(!e.getVisible()){var s=t.getZoom();$("#wpsl-map-controls").show(),t.setZoom(s-1),t.setZoom(s)}}))}(s,t)}(e,t):$(this).hasClass("wpsl-zoom-here")&&(t.setCenter(e.getPosition()),t.setZoom(o));return!1}))}(r,p),Q()}))})),n&&google.maps.event.addListener(r,"dragend",(function(e){X(true),t.setCenter(e.latLng),A(e.latLng),W(e.latLng,y,L=!1,l)}))}function H(e){if(e)return e.replace(/&#(\d+);/g,(function(e,t){return String.fromCharCode(t)}))}(_.templateSettings={evaluate:/\<\%(.+?)\%\>/g,interpolate:/\<\%=(.+?)\%\>/g,escape:/\<\%-(.+?)\%\>/g},wpsl.gmaps.init=function(l,i){var a,r,p,c,d,w,g,u,m,f,S=Number(wpslSettings.zoomLevel),b=Number(wpslSettings.autoZoomLevel);p=function(e){var t,s,o,n=["zoomLevel","mapType","mapTypeControl","mapStyle","streetView","scrollWheel","controlPosition"],l={zoomLevel:wpslSettings.zoomLevel,mapType:wpslSettings.mapType,mapTypeControl:wpslSettings.mapTypeControl,mapStyle:wpslSettings.mapStyle,streetView:wpslSettings.streetView,scrollWheel:wpslSettings.scrollWheel,controlPosition:wpslSettings.controlPosition,gestureHandling:wpslSettings.gestureHandling};if(void 0!==window["wpslMap_"+e]&&void 0!==window["wpslMap_"+e].shortCode)for(t=0,s=n.length;t<s;t++)void 0!==(o=window["wpslMap_"+e].shortCode[n[t]])&&(l[n[t]]=o);return l.startLatLng=function(e){var t,s,o="";void 0!==window["wpslMap_"+e]&&void 0!==window["wpslMap_"+e].locations&&(o=window["wpslMap_"+e].locations[0]);void 0!==o&&void 0!==o.lat&&void 0!==o.lng?t=new google.maps.LatLng(o.lat,o.lng):""!==wpslSettings.startLatlng?(s=wpslSettings.startLatlng.split(","),t=new google.maps.LatLng(s[0],s[1])):t=new google.maps.LatLng(0,0);return t}(e),l}(i),(u=Number(p.zoomLevel))!==S&&(b=u),c=I(),e=new google.maps.Geocoder,s=new google.maps.DirectionsRenderer,o=new google.maps.DirectionsService,a={zoom:u,center:p.startLatLng,mapTypeId:google.maps.MapTypeId[p.mapType.toUpperCase()],mapTypeControl:!!Number(p.mapTypeControl),streetViewControl:!!Number(p.streetView),gestureHandling:p.gestureHandling,zoomControlOptions:{position:google.maps.ControlPosition[p.controlPosition.toUpperCase()+"_TOP"]}},"cooperative"!==p.gestureHandling&&(a.scrollwheel=!!Number(p.scrollWheel)),v=function(){var e,t=wpslSettings.markerIconProps,s={};void 0!==t.url?s.url=t.url:void 0!==t.categoryMarkerUrl?s.categoryMarkerUrl=t.categoryMarkerUrl:void 0!==t.alternateMarkerUrl?s.alternateMarkerUrl=t.alternateMarkerUrl:s.url=wpslSettings.url+"img/markers/";for(var o in t)t.hasOwnProperty(o)&&2==(e=t[o].split(",")).length&&(s[o]=e);return s}(),t=new google.maps.Map(document.getElementById(l),a),(m=function(e){try{var t=JSON.parse(e);if(t&&"object"==typeof t&&null!==t)return t}catch(e){}return!1}(m=p.mapStyle))&&t.setOptions({styles:m}),void 0!==window["wpslMap_"+i]&&void 0!==window["wpslMap_"+i].locations&&(w=new google.maps.LatLngBounds,g=window["wpslMap_"+i].locations,$.each(g,(function(e){G(d=new google.maps.LatLng(g[e].lat,g[e].lng),g[e].id,g[e],!1,c),w.extend(d)})),g.length>1&&(se(t,b),t.fitBounds(w)),_.isArray(wpslSettings.mapTabAnchor)&&(r={map:t,bounds:w,maxZoom:b},h.push(r))),$("#wpsl-gmap").length&&(1==wpslSettings.autoComplete&&function(){var e,t,s,o={};oe(),void 0===wpslSettings.geocodeComponents||$.isEmptyObject(wpslSettings.geocodeComponents)||(o.componentRestrictions=wpslSettings.geocodeComponents,o.componentRestrictions=_.omit(o.componentRestrictions,"postalCode"));if(void 0!==wpslSettings.autoCompleteOptions&&!$.isEmptyObject(wpslSettings.autoCompleteOptions))for(var l in wpslSettings.autoCompleteOptions)wpslSettings.autoCompleteOptions.hasOwnProperty(l)&&(o[l]=wpslSettings.autoCompleteOptions[l]);e=document.getElementById("wpsl-search-input"),(t=new google.maps.places.Autocomplete(e,o)).addListener("place_changed",(function(){(s=t.getPlace()).geometry&&(n=s.geometry.location)}))}(),!E()&&$(".wpsl-dropdown").length&&1==wpslSettings.enableStyledDropdowns?(f=Number(wpslSettings.maxDropdownHeight),$(".wpsl-dropdown").each((function(e){var t,s,o=$(this);o.$dropdownWrap=o.wrap("<div class='wpsl-dropdown'></div>").parent(),o.$selectedVal=o.val(),o.$dropdownElem=$("<div><ul/></div>").appendTo(o.$dropdownWrap),o.$dropdown=o.$dropdownElem.find("ul"),o.$options=o.$dropdownWrap.find("option"),o.hide().removeClass("wpsl-dropdown"),$.each(o.$options,(function(){t=$(this).val()==o.$selectedVal?'class="wpsl-selected-dropdown"':"",o.$dropdown.append("<li data-value="+$(this).val()+" "+t+">"+$(this).text()+"</li>")})),o.$dropdownElem.before("<span data-value="+o.find(":selected").val()+" class='wpsl-selected-item'>"+o.find(":selected").text()+"</span>"),o.$dropdownItem=o.$dropdownElem.find("li"),o.$dropdownWrap.on("click",(function(e){$(this).hasClass("wpsl-active")?$(this).removeClass("wpsl-active"):(te(),$(this).toggleClass("wpsl-active"),s=0,$(this).hasClass("wpsl-active")?(o.$dropdownItem.each((function(e){s+=$(this).outerHeight()})),o.$dropdownElem.css("height",s+2+"px")):o.$dropdownElem.css("height",0),s>f&&($(this).addClass("wpsl-scroll-required"),o.$dropdownElem.css("height",f+"px")),e.stopPropagation())})),o.$dropdownItem.on("click",(function(e){o.$dropdownWrap.find($(".wpsl-selected-item")).html($(this).text()).attr("data-value",$(this).attr("data-value")),o.$dropdownItem.removeClass("wpsl-selected-dropdown"),$(this).addClass("wpsl-selected-dropdown"),te(),e.stopPropagation()}))})),$(document).click((function(){te()}))):($("#wpsl-search-wrap select").show(),E()?$("#wpsl-wrap").addClass("wpsl-mobile"):$("#wpsl-wrap").addClass("wpsl-default-filters")),$(".wpsl-search").hasClass("wpsl-widget")||(1==wpslSettings.autoLocate?N(p.startLatLng,c):1==wpslSettings.autoLoad&&M(p.startLatLng,c)),1!=wpslSettings.mouseFocus||E()||$("#wpsl-search-input").focus(),function(e){$("#wpsl-search-btn").bind("click",(function(t){return $("#wpsl-search-input").removeClass(),$("#wpsl-search-input").val()?(ne(),1==wpslSettings.autoComplete&&void 0!==n?j(n,e):Z(e)):$("#wpsl-search-input").addClass("wpsl-error").focus(),!1}))}(c),function(e,t,s){google.maps.event.addListenerOnce(t,"tilesloaded",(function(){$(".gm-style").append(wpslSettings.mapControls),$(".wpsl-icon-reset, #wpsl-reset-map").length>0&&(z(e.startLatLng,s),$(".wpsl-icon-reset").hide()),$(".wpsl-icon-direction").on("click",(function(){$(this).addClass("wpsl-user-activated"),N(e.startLatLng,s)}))}))}(p,t,c),$(".wpsl-search").hasClass("wpsl-widget")&&($("#wpsl-search-btn").trigger("click"),$(".wpsl-search").removeClass("wpsl-widget"))),void 0!==wpslSettings.markerZoomTo&&1==wpslSettings.markerZoomTo&&google.maps.event.addListener(t,"zoom_changed",(function(){Q()}))},$("#wpsl-result-list").on("click",".wpsl-back",(function(){var e,o;for(s.setMap(null),e=0,o=f.length;e<o;e++)f[e].setMap(t);return void 0!==r&&""!==r&&r.setMap(t),a&&F(),t.setCenter(S.centerLatlng),t.setZoom(S.zoomLevel),$(".wpsl-direction-before, .wpsl-direction-after").remove(),$("#wpsl-stores").show(),$("#wpsl-direction-details").hide(),!1})),$("#wpsl-gmap").length&&("bounce"==wpslSettings.markerEffect?($("#wpsl-stores").on("mouseenter","li",(function(){B($(this).data("store-id"),"start")})),$("#wpsl-stores").on("mouseleave","li",(function(){B($(this).data("store-id"),"stop")}))):"info_window"==wpslSettings.markerEffect&&$("#wpsl-stores").on("mouseenter","li",(function(){var e,s;for(e=0,s=f.length;e<s;e++)f[e].storeId==$(this).data("store-id")&&(google.maps.event.trigger(f[e],"click"),t.setCenter(f[e].position))}))),void 0!==wpslSettings.infoWindowStyle&&"infobox"==wpslSettings.infoWindowStyle&&1==wpslSettings.markerClusters)&&google.maps.event.addListener(t,"zoom_changed",(function(){google.maps.event.addListenerOnce(t,"idle",(function(){if(void 0!==a&&(c=a.clusters_).length)for(g=0,d=c.length;g<d;g++)for(u=0,w=c[g].markers_.length;u<w;u++)if(c[g].markers_[u].storeId==l){i.getVisible()&&null===c[g].markers_[u].map?i.setVisible(!1):i.getVisible()||null===c[g].markers_[u].map||i.setVisible(!0);break}}))}));function q(e,t,s,o){m.length=0,s.setContent(t),s.open(o,e),m.push(s),void 0!==wpslSettings.infoWindowStyle&&"infobox"==wpslSettings.infoWindowStyle&&1==wpslSettings.markerClusters&&(l=e.storeId,s.setVisible(!0))}function Q(){t.getZoom()>=wpslSettings.autoZoomLevel?$(".wpsl-zoom-here").hide():$(".wpsl-zoom-here").show()}var K={formatPhoneNumber:function(e){return(1==wpslSettings.phoneUrl&&E()||1==wpslSettings.clickableDetails)&&(e="<a href='tel:"+K.formatClickablePhoneNumber(e)+"'>"+e+"</a>"),e},formatClickablePhoneNumber:function(e){return-1!=e.indexOf("+")&&-1!=e.indexOf("(0)")&&(e=e.replace("(0)","")),e.replace(/(-| |\(|\)|\.|)/g,"")},formatEmail:function(e){return 1==wpslSettings.clickableDetails&&(e="<a href='mailto:"+e+"'>"+e+"</a>"),e},createInfoWindowActions:function(e){var t,s="",o="";return $("#wpsl-gmap").length&&(C&&(s="<a class='wpsl-streetview' href='#'>"+wpslLabels.streetView+"</a>"),1==wpslSettings.markerZoomTo&&(o="<a class='wpsl-zoom-here' href='#'>"+wpslLabels.zoomHere+"</a>"),t="<div class='wpsl-info-actions'>"+K.createDirectionUrl(e)+s+o+"</div>"),t},createDirectionUrl:function(e){var t,s,o={};return 1==wpslSettings.directionRedirect?(void 0===p&&(p=""),o.target="target='_blank'",void 0!==e?o.src=$("[data-store-id="+e+"] .wpsl-directions").attr("href"):(s=this.zip?this.zip+", ":"",t=this.address+", "+this.city+", "+s+this.country,o.src="https://www.google.com/maps/dir/?api=1&origin="+K.rfc3986EncodeURIComponent(p)+"&destination="+K.rfc3986EncodeURIComponent(t)+"&travelmode="+wpslSettings.directionsTravelMode.toLowerCase())):o={src:"#",target:""},"<a class='wpsl-directions' "+o.target+" href='"+o.src+"'>"+wpslLabels.directions+"</a>"},rfc3986EncodeURIComponent:function(e){return encodeURIComponent(e).replace(/[!'()*]/g,escape)}};function Y(e){var t;return t=$("#wpsl-base-gmap_0").length?$("#wpsl-cpt-info-window-template").html():$("#wpsl-info-window-template").html(),_.template(t)(e)}function J(){var e,s,o=Number(wpslSettings.autoZoomLevel),n=new google.maps.LatLngBounds;for(se(t,o),e=0,s=f.length;e<s;e++)n.extend(f[e].position);t.fitBounds(n)}function X(e){var t,o;if(s.setMap(null),f){for(o=0,t=f.length;o<t;o++)e?1!=f[o].draggable?f[o].setMap(null):r=f[o]:f[o].setMap(null);f.length=0}a&&a.clearMarkers()}function ee(e){var t;switch(e){case"ZERO_RESULTS":t=wpslLabels.noResults;break;case"OVER_QUERY_LIMIT":t=wpslLabels.queryLimit;break;default:t=wpslLabels.generalError}alert(t)}function te(){$(".wpsl-dropdown").removeClass("wpsl-active"),$(".wpsl-dropdown div").css("height",0)}function se(e,t){google.maps.event.addListenerOnce(e,"bounds_changed",(function(){google.maps.event.addListenerOnce(e,"idle",(function(){this.getZoom()>t&&this.setZoom(t)}))}))}function oe(){$("#wpsl-search-input").keypress((function(e){if(13==e.which)return ne(),Z(i),!1}))}function ne(){$("#wpsl-result-list ul").empty(),$("#wpsl-stores").show(),$(".wpsl-direction-before, .wpsl-direction-after").remove(),$("#wpsl-direction-details").hide(),y=!1,P(),X(!1),U()}$("#wpsl-stores").on("click",".wpsl-store-details",(function(){var e,t,s=$(this).parents("li"),o=s.data("store-id");if("info window"==wpslSettings.moreInfoLocation)for(e=0,t=f.length;e<t;e++)f[e].storeId==o&&google.maps.event.trigger(f[e],"click");else s.find(".wpsl-more-info-listings").is(":visible")?$(this).removeClass("wpsl-active-details"):$(this).addClass("wpsl-active-details"),s.siblings().find(".wpsl-store-details").removeClass("wpsl-active-details"),s.siblings().find(".wpsl-more-info-listings").hide(),s.find(".wpsl-more-info-listings").toggle();if("default"!=wpslSettings.templateId||"store listings"==wpslSettings.moreInfoLocation)return!1}))}));